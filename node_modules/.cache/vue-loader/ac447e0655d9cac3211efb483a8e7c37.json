{"remainingRequest":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/caijianli/Desktop/malladmin/src/components/editor/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/caijianli/Desktop/malladmin/src/components/editor/index.vue","mtime":1582099472000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRSBmcm9tICJ3YW5nZWRpdG9yIjsNCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7DQppbXBvcnQgeyB3YXJuaW5nTXNnLCB1dWlkLCBlcnJvck1zZyB9IGZyb20gIkAvY29tbW9udXRpbHMvY29tbW9uIjsNCmltcG9ydCBhcHBEYXRhIGZyb20gIkAvYXNzZXRzL2pzL2Vtb2ppLmpzb24iOw0KaW1wb3J0ICogYXMgYWxpUmVxdWVzdCBmcm9tICJAL2NvbW1vbnV0aWxzL2FsaU9TUyI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImluZGV4IiwNCiAgcHJvcHM6IHsNCiAgICBjb250ZW50OiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIg0KICAgIH0sDQogICAgbGF5b3V0OiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICBkZWZhdWx0KCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgIHdpZHRoOiAiMTAwJSIsDQogICAgICAgICAgaGVpZ2h0OiAiMTAwJSINCiAgICAgICAgfTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIEZJTEVfVFlQRV9BVkFUQVI6IHByb2Nlc3MuZW52LlZVRV9BUFBfRklMRV9UWVBFX0FWQVRBUiwNCiAgICAgIFNVQ0NfQ09ERTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX1NVQ0NfQ09ERSwNCiAgICAgIEVSUl9UT0tFTl9DT0RFOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfRVJSX1RPS0VOX0NPREUsDQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIGZhY2VMaXN0OiBbXSwNCiAgICAgIGVkaXRvcjogbnVsbCwNCiAgICAgIGlzZnVsbFNjcmVlbjogZmFsc2UsDQogICAgICBpc0NoYW5nZTogZmFsc2UNCiAgICB9Ow0KICB9LA0KICB3YXRjaDogew0KICAgIGNvbnRlbnQodmFsKSB7DQogICAgICBpZiAoIXRoaXMuaXNDaGFuZ2UpIHsNCiAgICAgICAgdGhpcy5lZGl0b3IudHh0Lmh0bWwodmFsKTsNCiAgICAgIH0NCiAgICAgIHRoaXMuaXNDaGFuZ2UgPSBmYWxzZTsNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoWyJ1c2VyIiwgImFsaXl1bk9zcyJdKQ0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuZmFjZUNvbnRlbnQoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHNldGZ1bGxTY3JlZW4oKSB7DQogICAgICB0aGlzLmlzZnVsbFNjcmVlbiA9ICF0aGlzLmlzZnVsbFNjcmVlbjsNCiAgICB9LA0KICAgIC8qKg0KICAgICAq6L295YWl6KGo5oOF5pWw57uEDQogICAgICogQHJldHVybiB7dm9pZH0NCiAgICAgKi8NCiAgICBmYWNlQ29udGVudCgpIHsNCiAgICAgIGZvciAobGV0IGkgaW4gYXBwRGF0YSkgew0KICAgICAgICB0aGlzLmZhY2VMaXN0LnB1c2goYXBwRGF0YVtpXS5jaGFyKTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgY29uc3QgdGhpc18gPSB0aGlzOw0KICAgIHRoaXMuZWRpdG9yID0gbmV3IEUodGhpcy4kcmVmcy5lZGl0b3JFbGVtKTsNCiAgICAvLyDnvJbovpHlmajnmoTkuovku7bvvIzmr4/mrKHmlLnlj5jkvJrojrflj5blhbZodG1s5YaF5a65DQogICAgdGhpcy5lZGl0b3IuY3VzdG9tQ29uZmlnLm9uY2hhbmdlID0gaHRtbCA9PiB7DQogICAgICB0aGlzLmlzQ2hhbmdlID0gdHJ1ZTsNCiAgICAgIHRoaXMuJGVtaXQoInVwZGF0ZTpjb250ZW50IiwgaHRtbCk7DQogICAgfTsNCiAgICB0aGlzLmVkaXRvci5jdXN0b21Db25maWcuaGVpZ2h0ID0gIjEwMCUiOw0KICAgIHRoaXMuZWRpdG9yLmN1c3RvbUNvbmZpZy51cGxvYWRJbWdNYXhTaXplID0gNSAqIDEwMjQgKiAxMDI0OyAvLyDlm77niYflpKflsI/kuI3otoXov4c1TQ0KICAgIHRoaXMuZWRpdG9yLmN1c3RvbUNvbmZpZy51cGxvYWRJbWdNYXhMZW5ndGggPSAxOyAvLyDkuIDmrKHmnIDlpJrog73kvKDlh6DlvKDlm77niYcNCiAgICB0aGlzLmVkaXRvci5jdXN0b21Db25maWcuY3VzdG9tQWxlcnQgPSBmdW5jdGlvbihpbmZvKSB7DQogICAgICB3YXJuaW5nTXNnKHRoaXNfLCBpbmZvKTsNCiAgICB9Ow0KICAgIHRoaXMuZWRpdG9yLmN1c3RvbUNvbmZpZy5jdXN0b21VcGxvYWRJbWcgPSBhc3luYyAoZmlsZXMsIGluc2VydCkgPT4gew0KICAgICAgbGV0IGltZ0ZpbGUgPSBmaWxlc1swXTsNCiAgICAgIHRoaXNfLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgaWYgKA0KICAgICAgICBpbWdGaWxlLnR5cGUgPT09ICJpbWFnZS9qcGciIHx8DQogICAgICAgIGltZ0ZpbGUudHlwZSA9PT0gImltYWdlL3BuZyIgfHwNCiAgICAgICAgaW1nRmlsZS50eXBlID09PSAiaW1hZ2UvanBlZyINCiAgICAgICkgew0KICAgICAgICBpbWdGaWxlID0gYXdhaXQgYWxpUmVxdWVzdC5Db21wcmVzc29ySW1nKGZpbGVzWzBdKTsNCiAgICAgIH0NCiAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGFsaVJlcXVlc3QuT3NzUmVxdXNldCgpOw0KICAgICAgY29uc3QgX29iaiA9IHRoaXMuYWxpeXVuT3NzLmltZ1BhdGggKyAiLyIgKyB1dWlkKCk7DQogICAgICBjbGllbnQNCiAgICAgICAgLnB1dChfb2JqLCBpbWdGaWxlKQ0KICAgICAgICAudGhlbihyMSA9PiB7DQogICAgICAgICAgaW5zZXJ0KHRoaXMuYWxpeXVuT3NzLmltZ0hvc3QgKyByMS5uYW1lKTsNCiAgICAgICAgICB0aGlzXy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnIgPT4gew0KICAgICAgICAgIGVycm9yTXNnKHRoaXMsIGVycik7DQogICAgICAgICAgdGhpc18ubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9Ow0KICAgIHRoaXMuZWRpdG9yLmN1c3RvbUNvbmZpZy5tZW51cyA9IFsNCiAgICAgICJoZWFkIiwgLy8g5qCH6aKYDQogICAgICAiYm9sZCIsIC8vIOeyl+S9kw0KICAgICAgImZvbnRTaXplIiwgLy8g5a2X5Y+3DQogICAgICAiZm9udE5hbWUiLCAvLyDlrZfkvZMNCiAgICAgICJpdGFsaWMiLCAvLyDmlpzkvZMNCiAgICAgICJ1bmRlcmxpbmUiLCAvLyDkuIvliJLnur8NCiAgICAgICJzdHJpa2VUaHJvdWdoIiwgLy8g5Yig6Zmk57q/DQogICAgICAiZm9yZUNvbG9yIiwgLy8g5paH5a2X6aKc6ImyDQogICAgICAiYmFja0NvbG9yIiwgLy8g6IOM5pmv6aKc6ImyDQogICAgICAibGluayIsIC8vIOaPkuWFpemTvuaOpQ0KICAgICAgImxpc3QiLCAvLyDliJfooagNCiAgICAgICJqdXN0aWZ5IiwgLy8g5a+56b2Q5pa55byPDQogICAgICAicXVvdGUiLCAvLyDlvJXnlKgNCiAgICAgICJlbW90aWNvbiIsIC8vIOihqOaDhQ0KICAgICAgImltYWdlIiwgLy8g5o+S5YWl5Zu+54mHDQogICAgICAvLyAndGFibGUnLCAvLyDooajmoLwNCiAgICAgICJjb2RlIiwgLy8g5o+S5YWl5Luj56CBDQogICAgICAidW5kbyIsIC8vIOaSpOmUgA0KICAgICAgInJlZG8iLCAvLyDph43lpI0NCiAgICAgICJmdWxsc2NyZWVuIg0KICAgIF07DQogICAgdGhpcy5lZGl0b3IuY3VzdG9tQ29uZmlnLnpJbmRleCA9IDA7DQogICAgdGhpcy5lZGl0b3IuY3VzdG9tQ29uZmlnLmVtb3Rpb25zID0gWw0KICAgICAgew0KICAgICAgICAvLyB0YWIg55qE5qCH6aKYDQogICAgICAgIHRpdGxlOiAi6buY6K6kIiwNCiAgICAgICAgLy8gdHlwZSAtPiAnZW1vamknIC8gJ2ltYWdlJw0KICAgICAgICB0eXBlOiAiaW1hZ2UiLA0KICAgICAgICAvLyBjb250ZW50IC0+IOaVsOe7hA0KICAgICAgICBjb250ZW50OiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgYWx0OiAiW+Wdj+eskV0iLA0KICAgICAgICAgICAgc3JjOg0KICAgICAgICAgICAgICAiaHR0cDovL2ltZy50LnNpbmFqcy5jbi90NC9hcHBzdHlsZS9leHByZXNzaW9uL2V4dC9ub3JtYWwvNTAvcGNtb3Jlbl9odWFpeGlhb19vcmcucG5nIg0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgYWx0OiAiW+iIlOWxj10iLA0KICAgICAgICAgICAgc3JjOg0KICAgICAgICAgICAgICAiaHR0cDovL2ltZy50LnNpbmFqcy5jbi90NC9hcHBzdHlsZS9leHByZXNzaW9uL2V4dC9ub3JtYWwvNDAvcGNtb3Jlbl90aWFuX29yZy5wbmciDQogICAgICAgICAgfQ0KICAgICAgICBdDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAvLyB0YWIg55qE5qCH6aKYDQogICAgICAgIHRpdGxlOiAiZW1vamkiLA0KICAgICAgICAvLyB0eXBlIC0+ICdlbW9qaScgLyAnaW1hZ2UnDQogICAgICAgIHR5cGU6ICJlbW9qaSIsDQogICAgICAgIC8vIGNvbnRlbnQgLT4g5pWw57uEDQogICAgICAgIGNvbnRlbnQ6IHRoaXMuZmFjZUxpc3QNCiAgICAgIH0NCiAgICBdOw0KICAgIHRoaXMuZWRpdG9yLmNyZWF0ZSgpOyAvLyDliJvlu7rlr4zmlofmnKzlrp7kvosNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/editor","sourcesContent":["<template>\r\n  <section class=\"page-layout\" :class=\"{'fullScreen': isfullScreen}\" :style=\"{width: layout.width, height: layout.height}\">\r\n    <div ref=\"editorElem\" v-loading=\"loading\" style=\"height: 100%\"></div>\r\n    <el-button type=\"text\" :title=\"isfullScreen ? '退出全屏' : '点击进入全屏编辑'\" class=\"fullScreenBtn\" @click=\"setfullScreen\">{{isfullScreen ? \"退出全屏编辑\" : \"全屏\"}}</el-button>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport E from \"wangeditor\";\r\nimport { mapState } from \"vuex\";\r\nimport { warningMsg, uuid, errorMsg } from \"@/commonutils/common\";\r\nimport appData from \"@/assets/js/emoji.json\";\r\nimport * as aliRequest from \"@/commonutils/aliOSS\";\r\n\r\nexport default {\r\n  name: \"index\",\r\n  props: {\r\n    content: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    layout: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          width: \"100%\",\r\n          height: \"100%\"\r\n        };\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      FILE_TYPE_AVATAR: process.env.VUE_APP_FILE_TYPE_AVATAR,\r\n      SUCC_CODE: process.env.VUE_APP_BASE_SUCC_CODE,\r\n      ERR_TOKEN_CODE: process.env.VUE_APP_BASE_ERR_TOKEN_CODE,\r\n      loading: false,\r\n      faceList: [],\r\n      editor: null,\r\n      isfullScreen: false,\r\n      isChange: false\r\n    };\r\n  },\r\n  watch: {\r\n    content(val) {\r\n      if (!this.isChange) {\r\n        this.editor.txt.html(val);\r\n      }\r\n      this.isChange = false;\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState([\"user\", \"aliyunOss\"])\r\n  },\r\n  created() {\r\n    this.faceContent();\r\n  },\r\n  methods: {\r\n    setfullScreen() {\r\n      this.isfullScreen = !this.isfullScreen;\r\n    },\r\n    /**\r\n     *载入表情数组\r\n     * @return {void}\r\n     */\r\n    faceContent() {\r\n      for (let i in appData) {\r\n        this.faceList.push(appData[i].char);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    const this_ = this;\r\n    this.editor = new E(this.$refs.editorElem);\r\n    // 编辑器的事件，每次改变会获取其html内容\r\n    this.editor.customConfig.onchange = html => {\r\n      this.isChange = true;\r\n      this.$emit(\"update:content\", html);\r\n    };\r\n    this.editor.customConfig.height = \"100%\";\r\n    this.editor.customConfig.uploadImgMaxSize = 5 * 1024 * 1024; // 图片大小不超过5M\r\n    this.editor.customConfig.uploadImgMaxLength = 1; // 一次最多能传几张图片\r\n    this.editor.customConfig.customAlert = function(info) {\r\n      warningMsg(this_, info);\r\n    };\r\n    this.editor.customConfig.customUploadImg = async (files, insert) => {\r\n      let imgFile = files[0];\r\n      this_.loading = true;\r\n      if (\r\n        imgFile.type === \"image/jpg\" ||\r\n        imgFile.type === \"image/png\" ||\r\n        imgFile.type === \"image/jpeg\"\r\n      ) {\r\n        imgFile = await aliRequest.CompressorImg(files[0]);\r\n      }\r\n      const client = await aliRequest.OssRequset();\r\n      const _obj = this.aliyunOss.imgPath + \"/\" + uuid();\r\n      client\r\n        .put(_obj, imgFile)\r\n        .then(r1 => {\r\n          insert(this.aliyunOss.imgHost + r1.name);\r\n          this_.loading = false;\r\n        })\r\n        .catch(err => {\r\n          errorMsg(this, err);\r\n          this_.loading = false;\r\n        });\r\n    };\r\n    this.editor.customConfig.menus = [\r\n      \"head\", // 标题\r\n      \"bold\", // 粗体\r\n      \"fontSize\", // 字号\r\n      \"fontName\", // 字体\r\n      \"italic\", // 斜体\r\n      \"underline\", // 下划线\r\n      \"strikeThrough\", // 删除线\r\n      \"foreColor\", // 文字颜色\r\n      \"backColor\", // 背景颜色\r\n      \"link\", // 插入链接\r\n      \"list\", // 列表\r\n      \"justify\", // 对齐方式\r\n      \"quote\", // 引用\r\n      \"emoticon\", // 表情\r\n      \"image\", // 插入图片\r\n      // 'table', // 表格\r\n      \"code\", // 插入代码\r\n      \"undo\", // 撤销\r\n      \"redo\", // 重复\r\n      \"fullscreen\"\r\n    ];\r\n    this.editor.customConfig.zIndex = 0;\r\n    this.editor.customConfig.emotions = [\r\n      {\r\n        // tab 的标题\r\n        title: \"默认\",\r\n        // type -> 'emoji' / 'image'\r\n        type: \"image\",\r\n        // content -> 数组\r\n        content: [\r\n          {\r\n            alt: \"[坏笑]\",\r\n            src:\r\n              \"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/50/pcmoren_huaixiao_org.png\"\r\n          },\r\n          {\r\n            alt: \"[舔屏]\",\r\n            src:\r\n              \"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/pcmoren_tian_org.png\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        // tab 的标题\r\n        title: \"emoji\",\r\n        // type -> 'emoji' / 'image'\r\n        type: \"emoji\",\r\n        // content -> 数组\r\n        content: this.faceList\r\n      }\r\n    ];\r\n    this.editor.create(); // 创建富文本实例\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.page-layout {\r\n  position: relative;\r\n  &.fullScreen {\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    z-index: 9999;\r\n    height: 100vh !important;\r\n    width: 100% !important;\r\n  }\r\n  .fullScreenBtn {\r\n    position: absolute;\r\n    z-index: 1;\r\n    top: 7px;\r\n    right: 10px;\r\n    padding: 0;\r\n    span {\r\n      font-size: 22px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.w-e-text-container{\r\n  height: calc(100% - 50px) !important;/*!important是重点，因为原div是行内样式设置的高度300px*/\r\n}\r\n</style>\r\n"]}]}