{"remainingRequest":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/caijianli/Desktop/malladmin/src/components/editor/index.vue?vue&type=style&index=1&lang=scss&","dependencies":[{"path":"/Users/caijianli/Desktop/malladmin/src/components/editor/index.vue","mtime":1582099472000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnctZS10ZXh0LWNvbnRhaW5lcnsNCiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA1MHB4KSAhaW1wb3J0YW50Oy8qIWltcG9ydGFudOaYr+mHjeeCue+8jOWboOS4uuWOn2RpduaYr+ihjOWGheagt+W8j+iuvue9rueahOmrmOW6pjMwMHB4Ki8NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4LA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/editor","sourcesContent":["<template>\r\n  <section class=\"page-layout\" :class=\"{'fullScreen': isfullScreen}\" :style=\"{width: layout.width, height: layout.height}\">\r\n    <div ref=\"editorElem\" v-loading=\"loading\" style=\"height: 100%\"></div>\r\n    <el-button type=\"text\" :title=\"isfullScreen ? '退出全屏' : '点击进入全屏编辑'\" class=\"fullScreenBtn\" @click=\"setfullScreen\">{{isfullScreen ? \"退出全屏编辑\" : \"全屏\"}}</el-button>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport E from \"wangeditor\";\r\nimport { mapState } from \"vuex\";\r\nimport { warningMsg, uuid, errorMsg } from \"@/commonutils/common\";\r\nimport appData from \"@/assets/js/emoji.json\";\r\nimport * as aliRequest from \"@/commonutils/aliOSS\";\r\n\r\nexport default {\r\n  name: \"index\",\r\n  props: {\r\n    content: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    layout: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          width: \"100%\",\r\n          height: \"100%\"\r\n        };\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      FILE_TYPE_AVATAR: process.env.VUE_APP_FILE_TYPE_AVATAR,\r\n      SUCC_CODE: process.env.VUE_APP_BASE_SUCC_CODE,\r\n      ERR_TOKEN_CODE: process.env.VUE_APP_BASE_ERR_TOKEN_CODE,\r\n      loading: false,\r\n      faceList: [],\r\n      editor: null,\r\n      isfullScreen: false,\r\n      isChange: false\r\n    };\r\n  },\r\n  watch: {\r\n    content(val) {\r\n      if (!this.isChange) {\r\n        this.editor.txt.html(val);\r\n      }\r\n      this.isChange = false;\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState([\"user\", \"aliyunOss\"])\r\n  },\r\n  created() {\r\n    this.faceContent();\r\n  },\r\n  methods: {\r\n    setfullScreen() {\r\n      this.isfullScreen = !this.isfullScreen;\r\n    },\r\n    /**\r\n     *载入表情数组\r\n     * @return {void}\r\n     */\r\n    faceContent() {\r\n      for (let i in appData) {\r\n        this.faceList.push(appData[i].char);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    const this_ = this;\r\n    this.editor = new E(this.$refs.editorElem);\r\n    // 编辑器的事件，每次改变会获取其html内容\r\n    this.editor.customConfig.onchange = html => {\r\n      this.isChange = true;\r\n      this.$emit(\"update:content\", html);\r\n    };\r\n    this.editor.customConfig.height = \"100%\";\r\n    this.editor.customConfig.uploadImgMaxSize = 5 * 1024 * 1024; // 图片大小不超过5M\r\n    this.editor.customConfig.uploadImgMaxLength = 1; // 一次最多能传几张图片\r\n    this.editor.customConfig.customAlert = function(info) {\r\n      warningMsg(this_, info);\r\n    };\r\n    this.editor.customConfig.customUploadImg = async (files, insert) => {\r\n      let imgFile = files[0];\r\n      this_.loading = true;\r\n      if (\r\n        imgFile.type === \"image/jpg\" ||\r\n        imgFile.type === \"image/png\" ||\r\n        imgFile.type === \"image/jpeg\"\r\n      ) {\r\n        imgFile = await aliRequest.CompressorImg(files[0]);\r\n      }\r\n      const client = await aliRequest.OssRequset();\r\n      const _obj = this.aliyunOss.imgPath + \"/\" + uuid();\r\n      client\r\n        .put(_obj, imgFile)\r\n        .then(r1 => {\r\n          insert(this.aliyunOss.imgHost + r1.name);\r\n          this_.loading = false;\r\n        })\r\n        .catch(err => {\r\n          errorMsg(this, err);\r\n          this_.loading = false;\r\n        });\r\n    };\r\n    this.editor.customConfig.menus = [\r\n      \"head\", // 标题\r\n      \"bold\", // 粗体\r\n      \"fontSize\", // 字号\r\n      \"fontName\", // 字体\r\n      \"italic\", // 斜体\r\n      \"underline\", // 下划线\r\n      \"strikeThrough\", // 删除线\r\n      \"foreColor\", // 文字颜色\r\n      \"backColor\", // 背景颜色\r\n      \"link\", // 插入链接\r\n      \"list\", // 列表\r\n      \"justify\", // 对齐方式\r\n      \"quote\", // 引用\r\n      \"emoticon\", // 表情\r\n      \"image\", // 插入图片\r\n      // 'table', // 表格\r\n      \"code\", // 插入代码\r\n      \"undo\", // 撤销\r\n      \"redo\", // 重复\r\n      \"fullscreen\"\r\n    ];\r\n    this.editor.customConfig.zIndex = 0;\r\n    this.editor.customConfig.emotions = [\r\n      {\r\n        // tab 的标题\r\n        title: \"默认\",\r\n        // type -> 'emoji' / 'image'\r\n        type: \"image\",\r\n        // content -> 数组\r\n        content: [\r\n          {\r\n            alt: \"[坏笑]\",\r\n            src:\r\n              \"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/50/pcmoren_huaixiao_org.png\"\r\n          },\r\n          {\r\n            alt: \"[舔屏]\",\r\n            src:\r\n              \"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/pcmoren_tian_org.png\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        // tab 的标题\r\n        title: \"emoji\",\r\n        // type -> 'emoji' / 'image'\r\n        type: \"emoji\",\r\n        // content -> 数组\r\n        content: this.faceList\r\n      }\r\n    ];\r\n    this.editor.create(); // 创建富文本实例\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.page-layout {\r\n  position: relative;\r\n  &.fullScreen {\r\n    position: fixed;\r\n    top: 0;\r\n    right: 0;\r\n    z-index: 9999;\r\n    height: 100vh !important;\r\n    width: 100% !important;\r\n  }\r\n  .fullScreenBtn {\r\n    position: absolute;\r\n    z-index: 1;\r\n    top: 7px;\r\n    right: 10px;\r\n    padding: 0;\r\n    span {\r\n      font-size: 22px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.w-e-text-container{\r\n  height: calc(100% - 50px) !important;/*!important是重点，因为原div是行内样式设置的高度300px*/\r\n}\r\n</style>\r\n"]}]}