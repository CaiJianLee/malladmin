{"remainingRequest":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/caijianli/Desktop/malladmin/src/views/container/orderRecording/index.vue?vue&type=style&index=1&lang=scss&","dependencies":[{"path":"/Users/caijianli/Desktop/malladmin/src/views/container/orderRecording/index.vue","mtime":1582099472000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/caijianli/Desktop/malladmin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5sYXlvdXQtY29udGVudCB7DQogIC5lbC10YWJsZS0tZW5hYmxlLXJvdy10cmFuc2l0aW9uIC5lbC10YWJsZV9fYm9keSB0ZC5wYTAtY2VsbCB7DQogICAgLmNlbGwgew0KICAgICAgcGFkZGluZy1sZWZ0OiAwOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAosBA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/container/orderRecording","sourcesContent":["<template>\r\n  <el-container class=\"layout\">\r\n    <el-header height=\"50px\" class=\"layout-title-box\">\r\n      <div class=\"titles\">{{ route.meta.title }}</div>\r\n    </el-header>\r\n    <el-header\r\n      style=\"min-height: 42px; height: auto\"\r\n      class=\"layout-title-box layout-title-filter\"\r\n    >\r\n      <div class=\"filter\">\r\n        <div class=\"filter-item\">\r\n          <label>买家账号</label>\r\n          <el-input\r\n            v-model=\"filter.account\"\r\n            clearable\r\n            placeholder=\"请输入账号搜索\"\r\n            style=\"width: 210px;\"\r\n          />\r\n        </div>\r\n        <div class=\"filter-item\">\r\n          <label>订单号</label>\r\n          <el-input\r\n            v-model=\"filter.id\"\r\n            clearable\r\n            placeholder=\"请输入订单号搜索\"\r\n            style=\"width: 210px;\"\r\n          />\r\n        </div>\r\n        <div class=\"filter-item\">\r\n          <label>订单状态</label>\r\n          <el-select\r\n            style=\"width: 140px\"\r\n            v-model=\"filter.status\"\r\n            placeholder=\"请选择\"\r\n          >\r\n            <el-option\r\n              :title=\"item.name\"\r\n              v-for=\"item in goodsStatusList\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            />\r\n          </el-select>\r\n        </div>\r\n        <div class=\"filter-item\">\r\n          <label>订单时间</label>\r\n          <el-date-picker\r\n            style=\"width: 250px\"\r\n            v-model=\"filter.orderTime\"\r\n            type=\"daterange\"\r\n            unlink-panels\r\n            :picker-options=\"pickerOptions\"\r\n            value-format=\"timestamp\"\r\n            range-separator=\"至\"\r\n            start-placeholder=\"开始日期\"\r\n            end-placeholder=\"结束日期\"\r\n          >\r\n          </el-date-picker>\r\n        </div>\r\n        <div class=\"filter-item btnItem\">\r\n          <el-button type=\"primary\" @click=\"filterData\">查询</el-button>\r\n        </div>\r\n        <div class=\"filter-item btnItem\">\r\n          <el-button type=\"info\" @click=\"restFilter\">重置</el-button>\r\n        </div>\r\n        <div class=\"filter-item btnItem\">\r\n          <el-button type=\"info\" icon=\"el-icon-download\" @click=\"exportOrderData\">导出</el-button>\r\n        </div>\r\n      </div>\r\n    </el-header>\r\n    <el-main v-if=\"tableData.length\" class=\"layout-content\">\r\n      <el-card\r\n        v-for=\"order in tableData\"\r\n        shadow=\"never\"\r\n        :key=\"order.id\"\r\n        body-style=\"border: 0;\"\r\n      >\r\n        <div class=\"order-title\">\r\n          <div class=\"items\">订单类型： {{ order.orderTypeName }}</div>\r\n          <div class=\"items\">订单编号： {{ order.id }}</div>\r\n          <div class=\"items\">订单时间： {{ dataFormat(order.createTime) }}</div>\r\n          <div class=\"items\">收货人： {{ order.receverName }}</div>\r\n        </div>\r\n        <el-table\r\n          border\r\n          min-height=\"500\"\r\n          :data=\"order.goodsList.list\"\r\n          :span-method=\"objectSpanMethod\"\r\n          size=\"medium\"\r\n          style=\"width: 100%;\"\r\n        >\r\n          <el-table-column\r\n            prop=\"name\"\r\n            show-overflow-tooltip\r\n            label=\"商品名称\"\r\n          ></el-table-column>\r\n          <el-table-column show-overflow-tooltip label=\"单价(￥)\">\r\n            <template slot-scope=\"scope\">\r\n              {{ regFenToYuan(scope.row.costPrice) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"number\"\r\n            show-overflow-tooltip\r\n            label=\"数量\"\r\n          ></el-table-column>\r\n          <el-table-column\r\n            prop=\"orderStatusName\"\r\n            show-overflow-tooltip\r\n            label=\"订单状态\"\r\n          >\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"afterSaleStatusName\"\r\n            show-overflow-tooltip\r\n            label=\"售后状态\"\r\n          ></el-table-column>\r\n          <el-table-column\r\n            prop=\"userAccount\"\r\n            show-overflow-tooltip\r\n            label=\"买家账号\"\r\n          ></el-table-column>\r\n          <el-table-column\r\n            prop=\"totalPrice\"\r\n            show-overflow-tooltip\r\n            label=\"实收金额(￥)\"\r\n          >\r\n            <template slot-scope=\"scope\">\r\n              {{ regFenToYuan(scope.row.totalPrice) }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button @click=\"openLogisticsSet(order)\" type=\"text\">编辑</el-button>\r\n              <el-button v-if=\"scope.row.orderStatus !== 7\" type=\"text\" @click=\"closeOrder(order)\">关闭</el-button>\r\n              <el-button type=\"text\" @click=\"showDetail(order)\">查看详情</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-card>\r\n      <div class=\"content-pagination\">\r\n        <el-pagination\r\n          background\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"page.currentPage\"\r\n          :page-sizes=\"pageSizes\"\r\n          :page-size=\"page.pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"page.total\"\r\n        />\r\n      </div>\r\n    </el-main>\r\n    <el-main v-else class=\"layout-content empty\">\r\n      <div class=\"empty\">\r\n        暂无订单记录\r\n      </div>\r\n    </el-main>\r\n    <el-dialog\r\n      title=\"关闭订单\"\r\n      width=\"600px \"\r\n      destroy-on-close\r\n      :close-on-click-modal=\"false\"\r\n      class=\"add-good-dialog\"\r\n      :visible.sync=\"closeOrderVis\"\r\n      @close=\"closeFormSetData\"\r\n    >\r\n      <el-form\r\n        :model=\"closeForm\"\r\n        label-width=\"100px\"\r\n        :rules=\"closeFormRule\"\r\n        ref=\"closeFormRule\"\r\n      >\r\n        <el-form-item label=\"关闭原因：\" prop=\"reason\">\r\n          <el-select v-model=\"closeForm.reason\" placeholder=\"请选择关闭原因\">\r\n            <el-option v-for=\"item in closeOrderList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.name\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\" 备注信息：\">\r\n          <el-input\r\n            style=\"width: 400px\"\r\n            rows=\"3\"\r\n            type=\"textarea\"\r\n            maxlength=\"200\"\r\n            show-word-limit\r\n            v-model=\"closeForm.remark\"\r\n            autocomplete=\"off\"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"closeOrderVis = false\">取 消</el-button>\r\n        <el-button @click=\"setFormSetData\" type=\"primary\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <el-dialog\r\n      title=\"编辑物流信息\"\r\n      width=\"600px \"\r\n      destroy-on-close\r\n      :close-on-click-modal=\"false\"\r\n      class=\"add-good-dialog\"\r\n      @close=\"closeLogistics\"\r\n      :visible.sync=\"editLogistics\"\r\n    >\r\n      <el-form\r\n        :model=\"logisticsForm\"\r\n        label-width=\"100px\"\r\n        :rules=\"logisticsRule\"\r\n        ref=\"logisticsRule\"\r\n      >\r\n        <el-form-item label=\"快递公司：\" prop=\"company\">\r\n          <el-select v-model=\"logisticsForm.company\" placeholder=\"请选择快递公司\">\r\n            <el-option v-for=\"item in exprressList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"物流单号：\" prop=\"trackingNumber\">\r\n          <el-input style=\"width: 400px\" v-model.number=\"logisticsForm.trackingNumber\"></el-input>\r\n        </el-form-item>\r\n        <el-alert title=\"请确认修改的快递公司和快递单号正确后，再点击确认按钮\" type=\"warning\" show-icon> </el-alert>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"editLogistics = false\">取 消</el-button>\r\n        <el-button @click=\"setLogisticsSetData\" :loading=\"isLogistics\" type=\"primary\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </el-container>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  successMsg,\r\n  jsonDeepClone,\r\n  STATUS_CODE,\r\n  errorMsg,\r\n  dataFormat,\r\n  regFenToYuan\r\n} from \"@/commonutils/common\";\r\nimport noImg from \"@/assets/images/noImg.jpg\";\r\nimport {\r\n  orderList,\r\n  exportOrder,\r\n  trackingNumber,\r\n  updateStatus\r\n} from \"./request\";\r\nimport { mapState } from \"vuex\";\r\n\r\nexport default {\r\n  name: \"index\",\r\n  data() {\r\n    // const checkNum = (rule, value, callback) => {\r\n    //   if (!value) {\r\n    //     return callback(new Error(\"物流单号不能为空\"));\r\n    //   }\r\n    //   if (!Number.isInteger(value)) {\r\n    //     callback(new Error(\"请输入数字值\"));\r\n    //   } else {\r\n    //     callback();\r\n    //   }\r\n    // };\r\n    return {\r\n      isLogistics: false,\r\n      closeFormRule: {\r\n        reason: [\r\n          {\r\n            required: true,\r\n            message: \"请选择关闭原因\",\r\n            trigger: \"change\"\r\n          }\r\n        ]\r\n      },\r\n      logisticsRule: {\r\n        company: [\r\n          {\r\n            required: true,\r\n            message: \"请选择快递公司\",\r\n            trigger: \"change\"\r\n          }\r\n        ],\r\n        trackingNumber: [\r\n          { required: true, message: \"请输入快递单号\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      closeForm: {\r\n        reason: \"\",\r\n        remark: \"\"\r\n      },\r\n      logisticsForm: {\r\n        company: \"\",\r\n        trackingNumber: \"\"\r\n      },\r\n      closeOrderList: JSON.parse(process.env.VUE_APP_PAGE_CLOSE_ORDER),\r\n      closeOrderVis: false,\r\n      editLogistics: false,\r\n      pickerOptions: {\r\n        shortcuts: [\r\n          {\r\n            text: \"最近一周\",\r\n            onClick(picker) {\r\n              const end = new Date();\r\n              const start = new Date();\r\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n              picker.$emit(\"pick\", [start, end]);\r\n            }\r\n          },\r\n          {\r\n            text: \"最近一个月\",\r\n            onClick(picker) {\r\n              const end = new Date();\r\n              const start = new Date();\r\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n              picker.$emit(\"pick\", [start, end]);\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      pageSizes: JSON.parse(process.env.VUE_APP_PAGE_SIZE),\r\n      noImg: noImg,\r\n      isLoading: false,\r\n      tableData: [],\r\n      filter: {\r\n        account: \"\",\r\n        id: \"\",\r\n        status: 0,\r\n        orderTime: [],\r\n        begin: \"\",\r\n        end: \"\"\r\n      },\r\n      page: {\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        total: 0\r\n      }\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"exprressList\"]),\r\n    goodsStatusList() {\r\n      const all = [{ id: 0, name: \"全部\" }];\r\n      const data = JSON.parse(process.env.VUE_APP_PAGE_ORDER_STATUS);\r\n      return [...all, ...data];\r\n    },\r\n    /**\r\n     * 路由信息\r\n     * @returns {Route} 路由信息\r\n     */\r\n    route() {\r\n      return this.$route;\r\n    },\r\n    /**\r\n     * 筛选列表\r\n     * @returns {[]} 筛选列表\r\n     */\r\n    statusList() {\r\n      let fliterList = [];\r\n      if (this.tableData.length) {\r\n        this.tableData.forEach(item => {\r\n          if (\r\n            fliterList.filter(ele => ele.text === item.statusName).length === 0\r\n          ) {\r\n            fliterList.push({\r\n              text: item.statusName,\r\n              value: item.statusName\r\n            });\r\n          }\r\n        });\r\n      }\r\n      return fliterList;\r\n    },\r\n    /**\r\n     * 设置状态颜色\r\n     * @returns {String} color\r\n     */\r\n    setFontColor() {\r\n      return val => {\r\n        switch (val) {\r\n          case \"交易完成\":\r\n            return \"#26AF61\";\r\n          case \"草稿\":\r\n            return \"#999\";\r\n          case \"订单取消\":\r\n            return \"#ff7736\";\r\n          default:\r\n            return \"#333\";\r\n        }\r\n      };\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * 查看订单详情\r\n     * @param {Object} item\r\n     * @returns {void}\r\n     */\r\n    showDetail(item) {\r\n      this.$router.push({\r\n        name: \"orderDetail\",\r\n        query: {\r\n          title_: this.route.meta.title,\r\n          path_: this.route.path,\r\n          id: item.id\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * 编辑订单\r\n     * @returns {void}\r\n     */\r\n    setLogisticsSetData() {\r\n      this.$refs[\"logisticsRule\"].validate(async valid => {\r\n        if (valid) {\r\n          this.isLogistics = true;\r\n          const { code, msg } = await trackingNumber({\r\n            orderId: this.logisticsForm.id,\r\n            trackingNumber: this.logisticsForm.trackingNumber.toString(),\r\n            companyId: this.logisticsForm.company\r\n          });\r\n          this.isLogistics = false;\r\n          if (code !== STATUS_CODE.success) {\r\n            errorMsg(this, msg);\r\n            return;\r\n          }\r\n          successMsg(this, \"编辑成功\");\r\n          this.editLogistics = false;\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * 编辑订单\r\n     * @param {Object} item\r\n     * @returns {void}\r\n     */\r\n    openLogisticsSet(item) {\r\n      this.$set(this.logisticsForm, \"id\", item.id);\r\n      this.editLogistics = true;\r\n    },\r\n    /**\r\n     * 关闭编辑订单弹窗\r\n     * @returns {void}\r\n     */\r\n    closeLogistics() {\r\n      this.$set(this.logisticsForm, \"id\", undefined);\r\n      this.$set(this.logisticsForm, \"trackingNumber\", \"\");\r\n      this.$set(this.logisticsForm, \"company\", \"\");\r\n      this.editLogistics = false;\r\n    },\r\n    /**\r\n     * 编辑关闭订单\r\n     * @returns {void}\r\n     */\r\n    setFormSetData() {\r\n      this.$refs[\"closeFormRule\"].validate(async valid => {\r\n        if (valid) {\r\n          const { code, msg } = await updateStatus({\r\n            id: this.closeForm.id,\r\n            reason: this.closeForm.reason,\r\n            remark: this.closeForm.remark\r\n          });\r\n          if (code !== STATUS_CODE.success) {\r\n            errorMsg(this, msg);\r\n            return;\r\n          }\r\n          successMsg(this, \"操作成功\");\r\n          this.getOrderList();\r\n          this.closeOrderVis = false;\r\n        }\r\n      });\r\n    },\r\n    /**\r\n     * 关闭编辑关闭订单弹窗\r\n     * @returns {void}\r\n     */\r\n    closeFormSetData() {\r\n      this.$set(this.closeForm, \"id\", undefined);\r\n      this.$set(this.closeForm, \"reason\", \"\");\r\n      this.$set(this.closeForm, \"remark\", \"\");\r\n    },\r\n    /**\r\n     * 打开编辑关闭订单弹窗\r\n     * @param {Object} item\r\n     * @returns {void}\r\n     */\r\n    closeOrder(item) {\r\n      this.$set(this.closeForm, \"id\", item.id);\r\n      this.closeOrderVis = true;\r\n    },\r\n    dataFormat,\r\n    regFenToYuan,\r\n    /**\r\n     * 格式化订单状态\r\n     * @param {Object} status\r\n     * @returns {void}\r\n     */\r\n    statusName(status) {\r\n      let statusName = \"-\";\r\n      if (status) {\r\n        this.goodsStatusList.forEach(item => {\r\n          if (item.id === status) {\r\n            statusName = item.name;\r\n          }\r\n        });\r\n      }\r\n      return statusName;\r\n    },\r\n    /**\r\n     * 合并表格行\r\n     * @param {Object} columnIndex\r\n     * @param {Object} rowIndex\r\n     * @returns {void}\r\n     */\r\n    objectSpanMethod({ row, column, rowIndex, columnIndex }) {\r\n      if (columnIndex === 7 || columnIndex === 6 || columnIndex === 5) {\r\n        if (rowIndex % row.goodsCount === 0) {\r\n          return {\r\n            rowspan: row.goodsCount,\r\n            colspan: 1\r\n          };\r\n        } else {\r\n          return {\r\n            rowspan: 0,\r\n            colspan: 0\r\n          };\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * 创建a标签并添加点击事件\r\n     * @param {String} blob\r\n     * @param {Object} fileName\r\n     * @returns {void}\r\n     */\r\n    downFile(blob, fileName) {\r\n      if (window.navigator.msSaveOrOpenBlob) {\r\n        navigator.msSaveBlob(blob, fileName);\r\n      } else {\r\n        let link = document.createElement(\"a\");\r\n        link.href = window.URL.createObjectURL(blob);\r\n        link.download = fileName;\r\n        link.click();\r\n        window.URL.revokeObjectURL(link.href);\r\n      }\r\n    },\r\n    /**\r\n     * 根据条件查询订单列表，并将excel文件流导出到本地\r\n     * @description 判断result是否为\"application/octet-stream\"文件流\r\n     * @description 非\"application/octet-stream\"，则解析result并显示错误信息\r\n     * @returns {void}\r\n     */\r\n    async exportOrderData() {\r\n      const params = {\r\n        page: this.page.currentPage,\r\n        pageSize: 10,\r\n        account: this.filter.account || undefined,\r\n        id: this.filter.id || undefined,\r\n        status: this.filter.status,\r\n        begin:\r\n          this.filter.orderTime && this.filter.orderTime[0]\r\n            ? parseInt(this.filter.orderTime[0] / 1000)\r\n            : undefined,\r\n        end:\r\n          this.filter.orderTime && this.filter.orderTime[1]\r\n            ? parseInt(this.filter.orderTime[1] / 1000)\r\n            : undefined\r\n      };\r\n      const data = await exportOrder(params);\r\n      // 判断返回是否为excel文件流\r\n      if (data.type !== \"application/octet-stream\") {\r\n        // 解析result，取出错误信息\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n          const result = JSON.parse(reader.result);\r\n          errorMsg(this, result.msg);\r\n        };\r\n        reader.readAsText(data);\r\n        return;\r\n      }\r\n      // 设置文件名，并下载到本地\r\n      let timestamp = new Date().getTime() + \".xlsx\";\r\n      let blob = new Blob([data], { type: \"application/octet-stream\" }),\r\n        fileName = `商品订单列表_${timestamp}`;\r\n      this.downFile(blob, fileName);\r\n      successMsg(this, `导出excel成功: 【${fileName}】`)\r\n    },\r\n    /**\r\n     * 获取订单列表\r\n     * @returns {void}\r\n     */\r\n    async getOrderList() {\r\n      this.isLoading = true;\r\n      if (!this.filter) return;\r\n      const params = {\r\n        page: this.page.currentPage,\r\n        pageSize: this.page.pageSize,\r\n        account: this.filter.account || undefined,\r\n        id: this.filter.id || undefined,\r\n        status: this.filter.status,\r\n        begin:\r\n          this.filter.orderTime && this.filter.orderTime[0]\r\n            ? parseInt(this.filter.orderTime[0] / 1000)\r\n            : undefined,\r\n        end:\r\n          this.filter.orderTime && this.filter.orderTime[1]\r\n            ? parseInt(this.filter.orderTime[1] / 1000)\r\n            : undefined\r\n      };\r\n      const data = await orderList(params);\r\n      this.isLoading = false;\r\n      if (data.code !== STATUS_CODE.success) {\r\n        errorMsg(this, data.msg);\r\n        return;\r\n      }\r\n      this.tableData = jsonDeepClone(data.result.list);\r\n      this.page.total = data.result.count;\r\n      this.tableData.forEach(item => {\r\n        item.price = parseInt(item.price);\r\n        item.createTime = parseInt(item.createTime);\r\n        item.goodsList.list.forEach(ele => {\r\n          ele.afterSaleStatusName = item.afterSaleStatusName || \"-\";\r\n          ele.userAccount = item.userAccount;\r\n          ele.goodsCount = item.goodsList.list.length;\r\n          ele.orderStatusName = item.statusName;\r\n          ele.orderStatus = item.status;\r\n        });\r\n      });\r\n    },\r\n    /**\r\n     * 筛选订单列表\r\n     * @returns {void}\r\n     */\r\n    filterData() {\r\n      this.page.pageSize = 10;\r\n      this.page.currentPage = 1;\r\n      this.getOrderList();\r\n    },\r\n    /**\r\n     * 重置筛选订单列表\r\n     * @returns {void}\r\n     */\r\n    restFilter() {\r\n      this.filter = {\r\n        id: \"\",\r\n        account: \"\",\r\n        orderTime: [],\r\n        status: 0\r\n      };\r\n      this.page.pageSize = 10;\r\n      this.page.currentPage = 1;\r\n      this.getOrderList();\r\n    },\r\n    /**\r\n     * 分页订单列表\r\n     * @param {Object} val\r\n     * @returns {void}\r\n     */\r\n    handleSizeChange(val) {\r\n      this.page.currentPage = 1;\r\n      this.page.pageSize = val;\r\n      this.getOrderList();\r\n    },\r\n    /**\r\n     * 分页订单列表\r\n     * @param {Object} val\r\n     * @returns {void}\r\n     */\r\n    handleCurrentChange(val) {\r\n      this.page.currentPage = val;\r\n      this.getOrderList();\r\n    }\r\n  },\r\n  created() {\r\n    this.getOrderList();\r\n  }\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.layout-content.empty {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  text-align: center;\r\n  .empty {\r\n    margin: 30px 0;\r\n  }\r\n}\r\n.goods-group-box {\r\n  text-overflow: -o-ellipsis-lastline;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 2;\r\n  line-clamp: 2;\r\n  -webkit-box-orient: vertical;\r\n}\r\n.order-title {\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  margin-bottom: 10px;\r\n  .items {\r\n    margin-right: 20px;\r\n  }\r\n}\r\n@media screen and (max-width: 1820px) {\r\n  .layout-title-box.layout-title-filter .filter .filter-item{\r\n    margin-bottom: 10px;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.layout-content {\r\n  .el-table--enable-row-transition .el-table__body td.pa0-cell {\r\n    .cell {\r\n      padding-left: 0;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}